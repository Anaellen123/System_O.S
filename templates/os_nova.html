{% extends "dashboard_base.html" %}
{% load static %}

{% block page_title %}Nova Ordem de Servi√ßo{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/os_nova.css' %}">

<div class="os-top">
  <a href="{% url 'dashboard' %}" class="os-back">‚Üê</a>
  <div class="os-title">
    <h1>Nova Ordem de Servi√ßo</h1>
    <p>Registre uma solicita√ß√£o de servi√ßo urbano preenchendo os campos abaixo</p>
  </div>
  
</div>

<form method="post" enctype="multipart/form-data" class="os-form">
  {% csrf_token %}

  <div class="os-grid">
    <section class="os-card">
      <div class="os-card-head">
        <div class="os-ico">üë§</div>
        <div>
          <h2>Solicitante</h2>
          <p>Quem est√° solicitando o servi√ßo</p>
        </div>
      </div>

      <div class="os-card-body">
        <div class="field">
          <label>Tipo de Pessoa *</label>
          <div class="chips" data-target="id_person_type">
            <button type="button" class="chip is-active" data-value="PF">Pessoa F√≠sica</button>
            <button type="button" class="chip" data-value="PJ">Pessoa Jur√≠dica</button>
          </div>
          {{ form.person_type }}
        </div>

        <div class="field">
          <label>CPF/CNPJ *</label>
          {{ form.document }}
        </div>

        <div class="field">
          <label>Nome Completo *</label>
          {{ form.full_name }}
        </div>

        <div class="field">
          <label>Telefone *</label>
          {{ form.phone }}
        </div>
      </div>
    </section>
    <section class="os-card">
      <div class="os-card-head">
        <div class="os-ico">üìç</div>
        <div>
          <h2>Localiza√ß√£o</h2>
          <p>Endere√ßo onde o servi√ßo ser√° realizado</p>
        </div>
      </div>

      <div class="os-card-body">
        <div class="grid-2">
          <div class="field">
            <label>CEP</label>
            {{ form.cep }}
          </div>
        </div>

        <div class="field">
          <label>Rua / Avenida</label>
          {{ form.street }}
        </div>

        <div class="grid-2">
          <div class="field">
            <label>N√∫mero</label>
            {{ form.number }}
          </div>
          <div class="field">
            <label>Complemento</label>
            <input type="text" name="complemento" placeholder="Apto, Sala..." />
          </div>
        </div>

        <div class="field">
          <label>Bairro</label>
          {{ form.neighborhood }}
        </div>

        <div class="grid-2">
          <div class="field">
            <label>Cidade</label>
            {{ form.city }}
          </div>
          <div class="field">
            <label>UF</label>
            <input type="text" name="uf" placeholder="UF" maxlength="2" />
          </div>
        </div>

        <div class="field">
          <label>Endere√ßo completo</label>
          <input type="text" name="endereco_completo" placeholder="Endere√ßo completo para refer√™ncia" />
        </div>
      </div>
    </section>

    <!-- SERVI√áO -->
    <section class="os-card">
      <div class="os-card-head">
        <div class="os-ico">üß∞</div>
        <div>
          <h2>Servi√ßo</h2>
          <p>Tipo de servi√ßo e canal de atendimento</p>
        </div>
      </div>

      <div class="os-card-body">
        <div class="field">
          <label>Tipo de Servi√ßo *</label>
          {{ form.service_type }}
        </div>

        <div class="field">
          <label>Descri√ß√£o *</label>
          {{ form.description }}
        </div>

        <div class="field">
          <label>Canal de Atendimento *</label>
          <div class="chips" data-target="id_channel">
            <button type="button" class="chip is-active" data-value="WHATS">WhatsApp</button>
            <button type="button" class="chip" data-value="PRES">Presencial</button>
          </div>
          <input type="hidden" id="id_channel" name="channel" value="WHATS">
        </div>
      </div>
    </section>
    <section class="os-card">
      <div class="os-card-head">
        <div class="os-ico">‚öôÔ∏è</div>
        <div>
          <h2>Configura√ß√µes</h2>
          <p>Prioridade e observa√ß√µes internas</p>
        </div>
      </div>

      <div class="os-card-body">
        <div class="field">
          <label>Prioridade *</label>
          <div class="chips chips-4" data-target="id_priority">
            <button type="button" class="chip" data-value="LOW">Baixa</button>
            <button type="button" class="chip is-active" data-value="MED">M√©dia</button>
            <button type="button" class="chip" data-value="HIGH">Alta</button>
            <button type="button" class="chip" data-value="URG">Urgente</button>
          </div>
          <input type="hidden" id="id_priority" name="priority" value="MED">
        </div>

        <div class="field">
          <label>Observa√ß√µes Internas <span class="muted">(Opcional)</span></label>
          {{ form.notes }}
        </div>
      </div>
    </section>
  </div>
  <div class="os-footer">
    <a href="{% url 'dashboard' %}" class="btn-light">Cancelar</a>
    <button type="submit" class="btn-primary">Criar Ordem de Servi√ßo</button>
  </div>
</form>

<script src="{% static 'js/os_nova.js' %}"></script>
{% endblock %}
